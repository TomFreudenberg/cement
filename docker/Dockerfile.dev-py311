FROM python:3.11-alpine
LABEL MAINTAINER="BJ Dierkes <derks@datafolklabs.com>"
ENV PS1="\[\e[0;33m\]|> cement-py311 <| \[\e[1;35m\]\W\[\e[0m\] \[\e[0m\]# "

WORKDIR /src
RUN apk update --no-check-certificate \
    && apk add --no-check-certificate libmemcached-dev \
        gcc \
        musl-dev \
        cyrus-sasl-dev \
        zlib-dev \
        make \
        vim \
        bash \
        git \
        libffi \
        libffi-dev \
        openssl-dev \
        jq \
        pipx \
    && ln -sf /usr/bin/vim /usr/bin/vi
RUN pipx install pdm
ENV PATH="${PATH}:/root/.local/bin"
COPY . /src
COPY docker/vimrc /root/.vimrc
RUN pdm venv create
RUN pdm install
CMD ["/bin/bash"]
